{%- assign headerSnippetPath = 'header-index' -%}
{%- assign wfPage = '687e7b1fe546230171c3f80b' -%}
{%- assign bodyClasses = '' -%}
<div class="page-wrapper home">
	{%- render 'global-styles' -%}
	{%- render 'navbar' -%}
	{%- render 'sidebar-cart' -%}
	<main class="main-wrapper">
		<header class="section_product-header7">
			<div class="padding-global">
				<div class="container-large">
					<div class="padding-section-large interna-produto">
						<div class="w-layout-grid product-header7_component">
							<div class="product-header7_gallery-slider">
								<div
									data-delay="4000"
									data-animation="cross"
									class="product-header7_slider w-slider"
									data-autoplay="false"
									data-easing="ease"
									data-hide-arrows="false"
									data-disable-swipe="false"
									data-w-id="a8878137-0271-8d6d-4fb7-ce8aef984ce5"
									data-autoplay-limit="0"
									data-nav-spacing="3"
									data-duration="500"
									data-infinite="true">
									<div class="w-slider-mask">
										{%- for image in product.images -%}
											<div class="product-header7_slide w-slide">
												<a
													href="{{ image | img_url: 'master' }}"
													class="product-header7_lightbox-link w-inline-block w-lightbox">
													<div class="product-header7_image-wrapper">
														<img
															loading="lazy"
															src="{{ image | img_url: '800x' }}"
															alt="{{ image.alt | default: product.title }}"
															width="800"
															height="800"
															class="product-header7_main-image">
													</div>
													<script
														type="application/json"
														class="w-json">
														{ "items": [{ "type": "image", "url": "{{ image | img_url: 'master' }}", "caption": "{{ image.alt | default: product.title }}" }], "group": "product-gallery" }
													</script>
												</a>
											</div>
										{%- endfor -%}
									</div>
									<div
										style="opacity:0"
										class="product-header7_arrow-left w-slider-arrow-left">
										<div class="product-header7_arrow-icon w-embed">
											<svg
												width="100%"
												height="100%"
												viewBox="0 0 16 16"
												fill="none"
												xmlns="http://www.w3.org/2000/svg">
												<path d="M3.31066 8.75001L9.03033 14.4697L7.96967 15.5303L0.439339 8.00001L7.96967 0.469676L9.03033 1.53034L3.31066 7.25001L15.5 7.25L15.5 8.75L3.31066 8.75001Z" fill="currentColor"></path>
											</svg>
										</div>
									</div>
									<div
										style="opacity:0"
										class="product-header7_arrow w-slider-arrow-right">
										<div class="product-header7_arrow-icon w-embed">
											<svg
												width="100%"
												height="100%"
												viewBox="0 0 16 16"
												fill="none"
												xmlns="http://www.w3.org/2000/svg">
												<path d="M12.6893 7.25L6.96967 1.53033L8.03033 0.469666L15.5607 8L8.03033 15.5303L6.96967 14.4697L12.6893 8.75H0.5V7.25H12.6893Z" fill="currentColor"></path>
											</svg>
										</div>
									</div>
									<div class="product-header7_slide-nav w-slider-nav w-slider-nav-invert w-round"></div>
								</div>
							</div>
							<div class="product-header7_product-details">
								<div class="breadcrumb_component">
									<a
										href="{{ routes.collections_url }}"
										class="breadcrumb-link w-inline-block">
										<div>Shop all</div>
									</a>
									<div class="breadcrumb-divider w-embed">
										<svg
											width="16"
											height="16"
											viewBox="0 0 16 16"
											fill="none"
											xmlns="http://www.w3.org/2000/svg">
											<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
										</svg>
									</div>
									{%- if product.collections.first -%}
										<a
											href="{{ product.collections.first.url }}"
											class="breadcrumb-link w-inline-block">
											<div class="text-weight-semibold">{{ product.collections.first.title }}</div>
										</a>
										<div class="breadcrumb-divider w-embed">
											<svg
												width="16"
												height="16"
												viewBox="0 0 16 16"
												fill="none"
												xmlns="http://www.w3.org/2000/svg">
												<path d="M6 3L11 8L6 13" stroke="CurrentColor" stroke-width="1.5"></path>
											</svg>
										</div>
									{%- endif -%}
									<a
										href="{{ product.url }}"
										class="breadcrumb-link w-inline-block">
										<div class="text-weight-semibold">{{ product.title }}</div>
									</a>
								</div>
								<div class="spacer-small"></div>
								<h1 class="heading-shop">{{ product.title }}</h1>
								<div class="spacer-small"></div>
								<div class="product-header7_price-wrapper">
									{%- if product.compare_at_price > product.price -%}
										<div class="heading-style-h5">
											<span class="compare-price">{{ product.compare_at_price | money }}</span>
											<span class="current-price">{{ product.price | money }}</span>
										</div>
									{%- else -%}
										<div class="heading-style-h5">{{ product.price | money }}</div>
									{%- endif -%}
									{%- if cart.taxes_included -%}
										<div class="text-size-tiny">Taxes included</div>
									{%- endif -%}
								</div>
								<div class="spacer-small"></div>
								<div class="product-header7_product-info">
									{{ product.description }}
								</div>
								<div class="spacer-small"></div>
								<div class="product-header7_add-to-cart w-form">
									{%- form 'product', product, class: 'product-header7_default-state', data-node-type: 'commerce-add-to-cart-form' -%}
										{%- render 'product-variants-data' -%}

										{%- unless product.has_only_default_variant -%}
											{%- for option in product.options_with_values -%}
												<div class="product-header7_option">
													<div class="form_field-label">{{ option.name }}</div>
													<select
														class="form_input w-select"
														name="options[{{ option.name | escape }}]"
														id="Option{{ forloop.index }}">
														{%- for value in option.values -%}
															<option
																value="{{ value | escape }}"
																{% if option.selected_value == value %}
																	selected="selected"
																{% endif %}>
																{{ value }}
															</option>
														{%- endfor -%}
													</select>
												</div>
											{%- endfor -%}
										{%- endunless -%}

										<div class="product-header7_option">
											<div class="form_field-label">Quantidade</div>
											<input
												class="form_input is-quantity-input w-input"
												maxlength="256"
												name="quantity"
												data-name="Quantity"
												placeholder="1"
												type="number"
												value="1"
												min="1"
												id="Quantity">
										</div>

										<div class="button-group">
											{%- if product.available -%}
												<button
													type="button"
													class="button"
													onclick="addToCartAndOpenSidebar()">
													SHOP
												</button>
											{%- else -%}
												<button
													type="button"
													class="button"
													disabled>
													Sold out
												</button>
											{%- endif -%}
										</div>

										<div
											class="w-commerce-commerceaddtocartoutofstock"
											style="display: none;">
											<div>Produto indisponível no momento.</div>
										</div>
										<div
											data-node-type="commerce-add-to-cart-error"
											style="display: none;">
											<div class="w-form-fail">
												<div>Preencha todos os campos obrigatórios.</div>
											</div>
										</div>
									{%- endform -%}
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</header>
		<!-- Related Products Section -->
		{%- if product.collections.first -%}
			<section class="section_layout195">
				<div class="padding-global">
					<div class="container-large">
						<div class="padding-section-small">
							<div class="layout195_component">
								<h2
									class="heading-related text-align-center">
									Outros produtos
								</h2>
								{%- for related_product in product.collections.first.products limit: 4 -%}
									{%- unless related_product.id == product.id -%}
										<div class="w-layout-grid layout195_content">
											<div
												data-delay="4000"
												data-animation="cross"
												class="gallery15_slider w-slider"
												data-autoplay="false"
												data-easing="ease"
												data-hide-arrows="false"
												data-disable-swipe="false"
												data-autoplay-limit="0"
												data-nav-spacing="3"
												data-duration="500"
												data-infinite="false"
												id="w-node-f7ea5feb-541b-92a4-52df-4d6bb7c14729-50830d4d-{{ forloop.index }}">
												<div class="gallery15_mask w-slider-mask">
													{% for image in related_product.images %}
														<div class="gallery15_slide w-slide">
															<div class="gallery15_image-wrapper">
																<img
																	sizes="(max-width: 647px) 100vw, 647px"
																	srcset="{{ image | img_url: '500x' }} 500w, {{ image | img_url: '647x' }} 647w"
																	alt="{{ image.alt | escape }}"
																	src="{{ image | img_url: '647x' }}"
																	loading="lazy"
																	class="gallery15_image">
															</div>
														</div>
													{% endfor %}
												</div>
												<div class="slider-arrow w-slider-arrow-left">
													<div class="slider-arrow-icon_default w-embed">
														<svg
															width="100%"
															height="100%"
															viewBox="0 0 16 16"
															fill="none"
															xmlns="http://www.w3.org/2000/svg">
															<path d="M3.31066 8.75001L9.03033 14.4697L7.96967 15.5303L0.439339 8.00001L7.96967 0.469676L9.03033 1.53034L3.31066 7.25001L15.5 7.25L15.5 8.75L3.31066 8.75001Z" fill="currentColor"></path>
														</svg>
													</div>
												</div>
												<div class="slider-arrow w-slider-arrow-right">
													<div class="slider-arrow-icon_default w-embed">
														<svg
															width="100%"
															height="100%"
															viewBox="0 0 16 16"
															fill="none"
															xmlns="http://www.w3.org/2000/svg">
															<path d="M12.6893 7.25L6.96967 1.53033L8.03033 0.469666L15.5607 8L8.03033 15.5303L6.96967 14.4697L12.6893 8.75H0.5V7.25H12.6893Z" fill="currentColor"></path>
														</svg>
													</div>
												</div>
												<div class="gallery15_slide-nav w-slider-nav w-slider-nav-invert w-round"></div>
											</div>
											<div
												id="w-node-d7866cc6-b936-b6e2-2039-8e1921661eda-50830d4d"
												class="layout195_content-right">
												<h2
													class="heading-shop">
													{{ related_product.title }}
												</h2>
												<div
													class="text-rich-text-shop w-richtext">
													{% if related_product.description != blank %}
														{{ related_product.description }}
													{% else %}
														<p>{{ related_product.title }} - Produto disponível em nossa loja.</p>
													{% endif %}
													{% if related_product.metafields.custom.features %}
														<ul
															role="list"
															class="list">
															{% assign features = related_product.metafields.custom.features | split: ',' %}
															{% for feature in features %}
																<li>{{ feature | strip }}</li>
															{% endfor %}
														</ul>
													{% endif %}
												</div>
												{% if related_product.metafields.custom.quantity %}
													<p
														class="text-quantity-description">
														{{ related_product.metafields.custom.quantity }}
													</p>
												{% endif %}

												<p class="text-quantity-description">23 adesivos secativos</p>

												<div
													class="price-wrapper">
													<div class="text-price-shop">
														{% if related_product.compare_at_price > related_product.price %}
															<span class="compare-price">{{ related_product.compare_at_price | money }}</span>
														{% endif %}
														{{ related_product.price | money }}
													</div>
												</div>
												<div
													class="button-group-shop">
													{%- if related_product.available -%}
														<a
															href="#"
															class="button-shop w-button"
															onclick="addRelatedProductToCart('{{ related_product.selected_or_first_available_variant.id }}', 1); return false;">
															SHOP
														</a>
													{%- else -%}
														<a
															href="#"
															class="button-shop w-button"
															style="opacity: 0.5; pointer-events: none;">
															Sold out
														</a>
													{%- endif -%}
												</div>
											</div>
										</div>
									{%- endunless -%}
								{%- endfor -%}
							</div>
						</div>
					</div>
				</div>
			</section>
		{%- endif -%}
	</main>
	{%- render 'footer' -%}
</div>

<style>
	.button-group {
		display: flex;
		gap: 10px;
		flex-wrap: wrap;
	}

	.sidebar-cart-trigger {
		background-color: #333 !important;
		color: #fff !important;
	}

	.sidebar-cart-trigger:hover {
		background-color: #555 !important;
	}

	/* Desktop grid positioning */
	@media screen and (min-width: 992px) {
		.layout195_content-right {
			display: grid;
			grid-template-columns: 1fr 1fr;
			gap: 20px;
		}

		.heading-shop {
			grid-area: 1 / 1 / 2 / 3;
		}

		.text-quantity-description {
			grid-area: 2 / 1 / 3 / 3;
		}

		.text-rich-text-shop {
			grid-area: 3 / 1 / 4 / 3;
		}

		.price-wrapper {
			grid-area: 4 / 1 / 5 / 2;
		}

		.button-group-shop {
			grid-area: 4 / 2 / 5 / 3;
			justify-self: end;
		}
	}

	/* Mobile grid positioning */
	@media screen and (max-width: 991px) {
		.layout195_content-right {
			grid-area: 1 / 1 / 2 / 3;
		}

		.heading-shop {
			grid-area: 1 / 1 / 2 / 3;
		}

		.text-quantity-description {
			grid-area: 2 / 1 / 3 / 3;
		}

		.price-wrapper {
			grid-area: 3 / 1 / 4 / 3;
		}

		.text-rich-text-shop {
			grid-area: 4 / 1 / 5 / 3;
		}

		.button-group-shop {
			grid-area: 5 / 1 / 6 / 3;
		}
	}
</style>
<script
	src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=687b9decde4053855982b5b1"
	type="text/javascript"
	integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
	crossorigin="anonymous"
	defer></script>
<script
	src="{{ 'webflow.js' | asset_url }}"
	type="text/javascript"
	defer></script>

<style>
	.button-group {
		display: flex;
		gap: 10px;
		flex-wrap: wrap;
	}

	.sidebar-cart-trigger {
		background-color: #333 !important;
		color: #fff !important;
	}

	.sidebar-cart-trigger:hover {
		background-color: #555 !important;
	}
</style>

<script>
	// Function to add product to cart and open sidebar
	function addToCartAndOpenSidebar() {
		const form = document.querySelector('.product-header7_default-state');
		const formData = new FormData(form);

		// Show loading state
		const button = event.target;
		const originalText = button.textContent;
		button.textContent = 'Adicionando...';
		button.disabled = true;

		fetch('/cart/add.js', {
			method: 'POST',
			body: formData,
		})
			.then(response => response.json())
			.then(data => {
				if (data.status) {
					// Error occurred
					alert('Error adding product to cart: ' + data.description);
				} else {
					// Success - update cart count and open sidebar
					updateCartCount();
					if (typeof window.openSidebarCart === 'function') {
						window.openSidebarCart();
					}
				}
			})
			.catch(error => {
				console.error('Error:', error);
				alert('Error adding product to cart');
			})
			.finally(() => {
				// Reset button state
				button.textContent = originalText;
				button.disabled = false;
			});
	}

	// Function to add specific product to cart by variant ID
	function addRelatedProductToCart(variantId, quantity = 1) {
		// Show loading state
		const button = event.target;
		const originalText = button.textContent;
		button.textContent = 'Adicionando...';
		button.disabled = true;

		const formData = new FormData();
		formData.append('id', variantId);
		formData.append('quantity', quantity);

		fetch('/cart/add.js', {
			method: 'POST',
			body: formData,
		})
			.then(response => response.json())
			.then(data => {
				if (data.status) {
					// Error occurred
					alert('Error adding product to cart: ' + data.description);
				} else {
					// Success - update cart count and open sidebar
					updateCartCount();
					if (typeof window.openSidebarCart === 'function') {
						window.openSidebarCart();
					}
				}
			})
			.catch(error => {
				console.error('Error:', error);
				alert('Error adding product to cart');
			})
			.finally(() => {
				// Reset button state
				button.textContent = originalText;
				button.disabled = false;
			});
	}

	// Function to update cart count and sidebar
	function updateCartCount() {
		fetch('/cart.js')
			.then(response => response.json())
			.then(cart => {
				console.log('Cart updated:', cart);

				const cartCountElements = document.querySelectorAll('.cart-quantity-text');
				cartCountElements.forEach(element => {
					element.textContent = cart.item_count;
				});

				// Update sidebar cart if it exists with a small delay to ensure DOM is ready
				if (typeof window.updateCartDisplay === 'function') {
					setTimeout(() => {
						window.updateCartDisplay(cart);
					}, 100);
				}
			})
			.catch(error => {
				console.error('Error updating cart count:', error);
			});
	}
</script>
